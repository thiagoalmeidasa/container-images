---
# yaml-language-server: $schema=https://raw.githubusercontent.com/goss-org/goss/master/docs/schema.yaml
file:
  /opt/bitnami/postgresql/lib/vectors.so:
    exists: true
  /opt/bitnami/postgresql/lib/vchord.so:
    exists: true
  /opt/bitnami/postgresql/share/extension/vector.control:
    exists: true
port:
  tcp6:5432:
    listening: true
command:
  'create test database':
    exit-status: 0
    exec: "psql -h localhost -p 5432 -U postgres -c 'CREATE DATABASE IF NOT EXISTS test;'"
    timeout: 2000  # in milliseconds
  'activate extension':
    exit-status: 0
    exec: "psql -h localhost -p 5432 -U postgres -d test -c 'CREATE EXTENSION IF NOT EXISTS vchord CASCADE;'"
    timeout: 2000  # in milliseconds
